With HighAnnualSales as (SELECT [yearly Product Sale].ProductID, max([yearly Product Sale].[Total Qty sold per year]) as highSalesFROM(select sod.ProductID, sum(sod.OrderQty) 'Total Qty sold per year'			from sales.SalesOrderDetail as sod			inner join sales.SalesOrderHeader as soh			on soh.SalesOrderID = sod.SalesOrderID			group by sod.ProductID, year(soh.orderDate)) as [yearly Product Sale]GROUP BY [yearly Product Sale].ProductID)select sod.ProductID, sum(sod.OrderQty) as 'Overall Quantity Sold', HighAnnualSales.highSales as "Highest Annual Sales"from sales.SalesOrderDetail as sodinner join HighAnnualSaleson HighAnnualSales.ProductID = sod.ProductIDwhere sod.ProductID not in (select ProductID							from sales.SalesOrderDetail as sod							where LineTotal < 100							group by productId							having count(ProductId) > 5)group by sod.ProductID, HighAnnualSales.highSalesorder by [Overall Quantity Sold] desc;-- Query to retreive a products highest annual sold quantityselect s.ProductID, year(soh.orderDate), sum(s.OrderQty)from sales.SalesOrderDetail as sinner join sales.SalesOrderHeader as sohon soh.SalesOrderID = s.SalesOrderIDgroup by s.ProductID, year(soh.orderDate)order by ProductID-- Query to retreive products that have been included in more than 5 small ordersselect ProductID, count(ProductID)from sales.SalesOrderDetail as sodwhere LineTotal < 100group by productIdhaving count(ProductId) > 5order by ProductID